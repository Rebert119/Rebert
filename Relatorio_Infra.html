
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório de Infraestrutura</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    
<style>
    :root { --primary: #004a8f; --secondary: #6c757d; --bg: #f4f6f9; }
    body { background-color: var(--bg); font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; }
    
    .top-bar { background: white; border-bottom: 3px solid var(--primary); padding: 15px 30px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .logo-area { display: flex; align-items: center; gap: 15px; }
    .logo-img { height: 45px; }
    .page-title { font-size: 1.25rem; font-weight: 600; color: var(--primary); margin: 0; }
    
    .main-content { padding: 30px; max-width: 1400px; margin: 0 auto; }
    
    .control-panel { background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 25px; display: flex; align-items: center; gap: 15px; }
    
    .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
    .kpi-card { background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; position: relative; overflow: hidden; }
    .kpi-label { font-size: 0.75rem; color: var(--secondary); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; margin-bottom: 8px; }
    .kpi-value { font-size: 1.8rem; font-weight: 700; color: #212529; }
    .kpi-card.highlight { border-left: 5px solid var(--primary); }
    
    .chart-container { background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
    
    .data-panel { background: white; border-radius: 8px; border: 1px solid #e0e0e0; overflow: hidden; }
    .panel-header { padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; background: #fff; }
    .btn-export { background-color: #198754; color: white; border: none; padding: 8px 16px; border-radius: 4px; font-weight: 500; font-size: 0.9rem; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 8px; }
    .btn-export:hover { background-color: #157347; }
    
    .custom-table { width: 100%; border-collapse: collapse; }
    .custom-table th { background: #f8f9fa; padding: 12px 20px; text-align: left; font-size: 0.85rem; color: #495057; border-bottom: 2px solid #dee2e6; }
    .custom-table td { padding: 12px 20px; border-bottom: 1px solid #eee; font-size: 0.95rem; }
    .status-tag { padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; }
    .tag-real { background: #d1e7dd; color: #0f5132; }
    .tag-proj { background: #fff3cd; color: #664d03; }
</style>

</head>
<body>
    <div class="top-bar">
        <div class="logo-area">
            <img src="data:image/png;base64,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" class="logo-img" onerror="this.style.display='none'">
            <h1 class="page-title">Painel de Infraestrutura: Análise & Projeção</h1>
        </div>
        <div class="text-muted small"></div>
    </div>

    <div class="main-content">
        <div class="control-panel">
            <label class="fw-bold text-secondary">Horizonte de Projeção:</label>
            <select id="periodoSelect" class="form-select" style="width: 200px;" onchange="renderDashboard()">
                <option value="90">90 dias</option>
                <option value="180" selected>180 dias</option>
                <option value="365">365 dias</option>
            </select>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-label">Custo Atual</div>
                <div class="kpi-value">R$ 537.41</div>
            </div>
            <div class="kpi-card highlight">
                <div class="kpi-label">Previsão de Custo</div>
                <div class="kpi-value" id="kpi-custo-final">--</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Variação de Custo</div>
                <div class="kpi-value text-danger" id="kpi-delta">--</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Volume de Dados Projetado</div>
                <div class="kpi-value text-primary" id="kpi-volume">--</div>
            </div>
        </div>

        <div class="chart-container">
            <div id="mainChart" style="height: 450px;"></div>
        </div>

        <div class="data-panel">
            <div class="panel-header">
                <h5 class="m-0 fw-bold text-secondary">Detalhamento Mensal (Histórico e Predição)</h5>
                <button onclick="exportToCSV()" class="btn-export">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/><path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/></svg>
                    Exportar Dados (.csv)
                </button>
            </div>
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>Referência (Mês/Ano)</th>
                        <th>Volume Médio (GB)</th>
                        <th>Custo Estimado</th>
                        <th>Status do Dado</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        
        let exportData = [];

        const sysConfig = {
            slope: 1.7445771526814986,
            intercept: -1287847.7702157935,
            lastOrdinal: 739603,
            priceUnit: 0.22,
            history: {"x": ["2024-03-22", "2024-03-23", "2024-03-24", "2024-03-25", "2024-03-26", "2024-03-27", "2024-03-28", "2024-03-29", "2024-03-30", "2024-03-31", "2024-04-01", "2024-04-02", "2024-04-03", "2024-04-04", "2024-04-05", "2024-04-06", "2024-04-07", "2024-04-08", "2024-04-09", "2024-04-10", "2024-04-11", "2024-04-12", "2024-04-13", "2024-04-14", "2024-04-15", "2024-04-16", "2024-04-17", "2024-04-18", "2024-04-19", "2024-04-20", "2024-04-21", "2024-04-22", "2024-04-23", "2024-04-24", "2024-04-25", "2024-04-26", "2024-04-27", "2024-04-28", "2024-04-29", "2024-04-30", "2024-05-01", "2024-05-02", "2024-05-03", "2024-05-04", "2024-05-05", "2024-05-06", "2024-05-07", "2024-05-08", "2024-05-09", "2024-05-10", "2024-05-11", "2024-05-12", "2024-05-13", "2024-05-14", "2024-05-15", "2024-05-16", "2024-05-17", "2024-05-18", "2024-05-19", "2024-05-20", "2024-05-21", "2024-05-22", "2024-05-23", "2024-05-24", "2024-05-25", "2024-05-26", "2024-05-27", "2024-05-28", "2024-05-29", "2024-05-30", "2024-05-31", "2024-06-01", "2024-06-02", "2024-06-03", "2024-06-04", "2024-06-05", "2024-06-06", "2024-06-07", "2024-06-08", "2024-06-09", "2024-06-10", "2024-06-11", "2024-06-12", "2024-06-13", "2024-06-14", "2024-06-15", "2024-06-16", "2024-06-17", "2024-06-18", "2024-06-19", "2024-06-20", "2024-06-21", "2024-06-22", "2024-06-23", "2024-06-24", "2024-06-25", "2024-06-26", "2024-06-27", "2024-06-28", "2024-06-29", "2024-06-30", "2024-07-01", "2024-07-02", "2024-07-03", "2024-07-04", "2024-07-05", "2024-07-06", "2024-07-07", "2024-07-08", "2024-07-09", "2024-07-10", "2024-07-11", "2024-07-12", "2024-07-13", "2024-07-14", "2024-07-15", "2024-07-16", "2024-07-17", "2024-07-18", "2024-07-19", "2024-07-20", "2024-07-21", "2024-07-22", "2024-07-23", "2024-07-24", "2024-07-25", "2024-07-26", "2024-07-27", "2024-07-28", "2024-07-29", "2024-07-30", "2024-07-31", "2024-08-01", "2024-08-02", "2024-08-03", "2024-08-04", "2024-08-05", "2024-08-06", "2024-08-07", "2024-08-08", "2024-08-09", "2024-08-10", "2024-08-11", "2024-08-12", "2024-08-13", "2024-08-14", "2024-08-15", "2024-08-16", "2024-08-17", "2024-08-18", "2024-08-19", "2024-08-20", "2024-08-21", "2024-08-22", "2024-08-23", "2024-08-24", "2024-08-25", "2024-08-26", "2024-08-27", "2024-08-28", "2024-08-29", "2024-08-30", "2024-08-31", "2024-09-01", "2024-09-02", "2024-09-03", "2024-09-04", "2024-09-05", "2024-09-06", "2024-09-07", "2024-09-08", "2024-09-09", "2024-09-10", "2024-09-11", "2024-09-12", "2024-09-13", "2024-09-14", "2024-09-15", "2024-09-16", "2024-09-17", "2024-09-18", "2024-09-19", "2024-09-20", "2024-09-21", "2024-09-22", "2024-09-23", "2024-09-24", "2024-09-25", "2024-09-26", "2024-09-27", "2024-09-28", "2024-09-29", "2024-09-30", "2024-10-01", "2024-10-02", "2024-10-03", "2024-10-04", "2024-10-05", "2024-10-06", "2024-10-07", "2024-10-08", "2024-10-09", "2024-10-10", "2024-10-11", "2024-10-12", "2024-10-13", "2024-10-14", "2024-10-15", "2024-10-16", "2024-10-17", "2024-10-18", "2024-10-19", "2024-10-20", "2024-10-21", "2024-10-22", "2024-10-23", "2024-10-24", "2024-10-25", "2024-10-26", "2024-10-27", "2024-10-28", "2024-10-29", "2024-10-30", "2024-10-31", "2024-11-01", "2024-11-02", "2024-11-03", "2024-11-04", "2024-11-05", "2024-11-06", "2024-11-07", "2024-11-08", "2024-11-09", "2024-11-10", "2024-11-11", "2024-11-12", "2024-11-13", "2024-11-14", "2024-11-15", "2024-11-16", "2024-11-17", "2024-11-18", "2024-11-19", "2024-11-20", "2024-11-21", "2024-11-22", "2024-11-23", "2024-11-24", "2024-11-25", "2024-11-26", "2024-11-27", "2024-11-28", "2024-11-29", "2024-11-30", "2024-12-01", "2024-12-02", "2024-12-03", "2024-12-04", "2024-12-05", "2024-12-06", "2024-12-07", "2024-12-08", "2024-12-09", "2024-12-10", "2024-12-11", "2024-12-12", "2024-12-13", "2024-12-14", "2024-12-15", "2024-12-16", "2024-12-17", "2024-12-18", "2024-12-19", "2024-12-20", "2024-12-21", "2024-12-22", "2024-12-23", "2024-12-24", "2024-12-25", "2024-12-26", "2024-12-27", "2024-12-28", "2024-12-29", "2024-12-30", "2024-12-31", "2025-01-01", "2025-01-02", "2025-01-03", "2025-01-04", "2025-01-05", "2025-01-06", "2025-01-07", "2025-01-08", "2025-01-09", "2025-01-10", "2025-01-11", "2025-01-12", "2025-01-13", "2025-01-14", "2025-01-15", "2025-01-16", "2025-01-17", "2025-01-18", "2025-01-19", "2025-01-20", "2025-01-21", "2025-01-22", "2025-01-23", "2025-01-24", "2025-01-25", "2025-01-26", "2025-01-27", "2025-01-28", "2025-01-29", "2025-01-30", "2025-01-31", "2025-02-01", "2025-02-02", "2025-02-03", "2025-02-04", "2025-02-05", "2025-02-06", "2025-02-07", "2025-02-08", "2025-02-09", "2025-02-10", "2025-02-11", "2025-02-12", "2025-02-13", "2025-02-14", "2025-02-15", "2025-02-16", "2025-02-17", "2025-02-18", "2025-02-19", "2025-02-20", "2025-02-21", "2025-02-22", "2025-02-23", "2025-02-24", "2025-02-25", "2025-02-26", "2025-02-27", "2025-02-28", "2025-03-01", "2025-03-02", "2025-03-03", "2025-03-04", "2025-03-05", "2025-03-06", "2025-03-07", "2025-03-08", "2025-03-09", "2025-03-10", "2025-03-11", "2025-03-12", "2025-03-13", "2025-03-14", "2025-03-15", "2025-03-16", "2025-03-17", "2025-03-18", "2025-03-19", "2025-03-20", "2025-03-21", "2025-03-22", "2025-03-23", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-29", "2025-03-30", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-03", "2025-04-04", "2025-04-05", "2025-04-06", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-12", "2025-04-13", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-18", "2025-04-19", "2025-04-20", "2025-04-21", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-26", "2025-04-27", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-01", "2025-05-02", "2025-05-03", "2025-05-04", "2025-05-05", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-10", "2025-05-11", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-17", "2025-05-18", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-24", "2025-05-25", "2025-05-26", "2025-05-27", "2025-05-28", "2025-05-29", "2025-05-30", "2025-05-31", "2025-06-01", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-07", "2025-06-08", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-14", "2025-06-15", "2025-06-16", "2025-06-17", "2025-06-18", "2025-06-19", "2025-06-20", "2025-06-21", "2025-06-22", "2025-06-23", "2025-06-24", "2025-06-25", "2025-06-26", "2025-06-27", "2025-06-28", "2025-06-29", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-05", "2025-07-06", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-12", "2025-07-13", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-19", "2025-07-20", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-26", "2025-07-27", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-02", "2025-08-03", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-09", "2025-08-10", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-15", "2025-08-16", "2025-08-17", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-23", "2025-08-24", "2025-08-25", "2025-08-26", "2025-08-27", "2025-08-28", "2025-08-29", "2025-08-30", "2025-08-31", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-06", "2025-09-07", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-13", "2025-09-14", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-20", "2025-09-21", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-27", "2025-09-28", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-02", "2025-10-03", "2025-10-04", "2025-10-05", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-11", "2025-10-12", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-18", "2025-10-19", "2025-10-20", "2025-10-21", "2025-10-22", "2025-10-23", "2025-10-24", "2025-10-25", "2025-10-26", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-01", "2025-11-02", "2025-11-03", "2025-11-04", "2025-11-05", "2025-11-06", "2025-11-07", "2025-11-08", "2025-11-09", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14", "2025-11-15", "2025-11-16", "2025-11-17", "2025-11-18", "2025-11-19", "2025-11-20", "2025-11-21", "2025-11-22", "2025-11-23", "2025-11-24", "2025-11-25", "2025-11-26", "2025-11-27", "2025-11-28", "2025-11-29", "2025-11-30", "2025-12-01", "2025-12-02", "2025-12-03", "2025-12-04", "2025-12-05", "2025-12-06", "2025-12-07", "2025-12-08", "2025-12-09", "2025-12-10", "2025-12-11", "2025-12-12", "2025-12-13", "2025-12-14", "2025-12-15", "2025-12-16", "2025-12-17", "2025-12-18"], "y": [311.5246241760254, 310.8655825805664, 311.96539291381833, 312.1897888183594, 312.8696450805664, 318.28497146606446, 318.79206481933596, 319.77517807006836, 317.9224008178711, 318.37531829833983, 319.05184616088866, 319.60916763305664, 321.12118087768556, 321.9767071533203, 322.84073150634765, 323.0716247558594, 323.3400434875488, 324.02034286499025, 324.7450964355469, 323.75457778930667, 324.12104919433597, 324.38958877563476, 323.06844070434573, 323.4711972045898, 326.1536389160156, 326.4881590270996, 328.4779176330566, 328.55235595703124, 330.2203189086914, 329.6252621459961, 329.9896891784668, 330.3339041137695, 330.87458862304686, 330.73837265014646, 331.035629119873, 331.32377990722654, 330.37542602539065, 330.69580841064453, 331.1559114074707, 331.6421649169922, 332.8587008666992, 333.71485153198245, 334.68367095947264, 333.0304801940918, 333.9174072265625, 334.96683334350587, 333.57196533203125, 334.4344773864746, 335.2019143676758, 336.1789431762695, 335.94092483520507, 337.0289791870117, 338.11048919677734, 339.392960357666, 340.5542042541504, 341.77857528686525, 342.92922470092776, 342.67917343139646, 343.7123654174805, 344.78642471313475, 345.70662734985353, 347.76535079956057, 349.0419926452637, 349.9897003173828, 349.84858154296876, 351.06160614013675, 351.98505661010745, 353.6599298095703, 355.1839692687988, 356.2345820617676, 357.1380554199219, 356.6312155151367, 357.4602555847168, 358.4100193786621, 363.45271102905275, 368.23908401489257, 365.0191636657715, 367.33831130981446, 367.12274917602537, 367.51701263427736, 368.5170867919922, 369.48111587524414, 371.14946990966797, 372.3141361999512, 373.1232713317871, 372.6900305175781, 373.9336418151855, 374.8621310424805, 376.1460708618164, 377.440714263916, 380.24767639160154, 380.61549057006835, 379.8784170532227, 381.12256713867185, 382.1293887329102, 383.9967283630371, 385.2358396911621, 386.34420852661134, 387.70509765625, 387.57099487304686, 388.9420487976074, 389.9506042480469, 391.08353912353516, 391.92838027954105, 392.9099057006836, 393.76051071166995, 393.0732943725586, 393.5568623352051, 394.86919677734375, 396.0260514831543, 399.335325012207, 53.95441925048828, 402.72975723266603, 400.0643620300293, 402.00773956298826, 403.07153167724607, 404.2973327636719, 404.30582412719724, 303.27017959594724, 305.14239852905274, 301.9581489562988, 302.8322877502441, 303.5151635742188, 304.16364761352537, 308.9412052917481, 310.24767684936523, 310.89079986572267, 309.6076271057129, 310.35331451416016, 310.7958724975586, 311.6551937866211, 312.4569738769531, 312.9711839294434, 315.06119400024414, 313.7502963256836, 313.80318984985354, 314.00175415039064, 315.46497436523435, 316.08449478149413, 316.8258232116699, 317.0510046386719, 316.3851921081543, 316.78455307006834, 316.92088989257815, 317.8583438110352, 318.46194061279294, 319.55810699462893, 322.6238383483887, 321.28242782592775, 322.0036616516113, 322.4341195678711, 325.448543548584, 325.2237884521484, 321.30599517822264, 321.8596189880371, 323.77685440063476, 323.2951075744629, 323.7331253051758, 324.4722415161133, 325.0931802368164, 326.2628063964844, 327.1109390258789, 325.93910736083984, 326.70744567871094, 327.18255752563476, 327.46807815551756, 327.9763262939453, 329.01589981079104, 330.3316616821289, 330.3429963684082, 330.71472808837893, 331.23303024291994, 332.58855499267577, 333.21494537353516, 336.2001321411133, 334.2406983947754, 333.4354187011719, 334.0480238342285, 334.41973876953125, 334.4923341369629, 335.60090270996096, 337.49866790771483, 338.2705226135254, 337.4961334228516, 337.7040534973145, 338.1557322692871, 340.1675257873535, 340.9540821838379, 343.0195933532715, 343.30737152099607, 342.69094955444336, 342.6201887512207, 343.3657737731934, 344.32924224853514, 344.4057652282715, 346.8231887817383, 347.5212026977539, 348.69691497802734, 349.19002838134764, 349.37699615478516, 350.485218963623, 351.28516616821287, 351.7201156616211, 352.44199569702147, 351.82351257324217, 352.2079167175293, 352.98947128295896, 353.29531814575193, 355.03996520996094, 356.7744625854492, 357.0070947265625, 354.59298446655276, 356.45175552368164, 356.9130082702637, 357.860714263916, 355.6200903320312, 360.743289642334, 361.27753219604494, 360.3205342102051, 360.6398793029785, 361.1347315979004, 361.9381297302246, 362.57573059082034, 363.0539308166504, 363.6972418212891, 360.7324769592285, 360.7023568725586, 361.30425506591797, 361.873921661377, 361.7176245117187, 365.28333251953126, 366.00302551269533, 365.28187728881835, 365.1324383544922, 365.44966354370115, 366.57668685913086, 366.86953567504884, 367.700682220459, 368.3659391784668, 367.40009567260745, 367.8006785583496, 368.715827331543, 370.62032989501955, 371.2794000244141, 371.7028033447266, 376.33694107055663, 376.2343045043945, 376.50161544799806, 377.2721240234375, 378.40163314819335, 379.2710235595703, 379.705506439209, 380.62796157836914, 380.31418060302735, 380.75702728271483, 381.3251950073242, 383.26054107666016, 383.82075622558597, 382.94283081054687, 382.75265548706057, 383.2211944580078, 383.61761978149417, 384.17535751342774, 384.1954672241211, 384.61682281494143, 397.85348556518557, 409.5536328125, 421.35267028808596, 421.3678923034668, 422.1847483825684, 435.0404327392578, 440.75532012939453, 439.86415664672853, 442.90965240478516, 443.42131286621094, 443.5124385070801, 444.1138096618652, 444.84347610473634, 444.8757244873047, 445.34804168701174, 445.6550651550293, 450.9132467651367, 357.9777537536621, 354.2823908996582, 365.78539886474607, 365.85238983154295, 366.00322525024416, 367.7675489807129, 365.03240844726565, 365.31711669921873, 365.2396420288086, 367.0568962097168, 367.3999899291992, 369.7352424621582, 370.2563510131836, 367.16510360717774, 367.23809677124024, 367.3092822265625, 372.0559342956543, 371.5431727600098, 373.09176483154295, 375.65401992797854, 376.94207366943357, 376.3654397583008, 377.0595361328125, 377.666630859375, 385.6193928527832, 385.868505859375, 388.9817965698242, 388.78497619628905, 388.8073501586914, 389.5108476257324, 390.6463203430176, 390.8711828613281, 391.37769546508787, 392.22688888549806, 392.43743576049803, 392.2641323852539, 392.4243873596191, 393.72177505493164, 394.704822845459, 395.3028102111816, 395.3240428161621, 395.3682905578613, 395.58545562744143, 395.96333892822264, 396.91171798706057, 397.7008692932129, 398.3427082824707, 398.72224487304686, 398.79477310180664, 399.4903045654297, 399.4567973327637, 400.58709701538083, 401.06578903198243, 402.18393325805664, 402.12526412963865, 402.2039640808105, 402.7328355407715, 402.9427848815918, 403.8276239013672, 404.4269641113281, 405.015256652832, 405.7585153198242, 405.7667012023926, 406.2042808532715, 406.31608352661135, 406.8745178222656, 407.4495840454102, 408.0408122253418, 408.4849143981934, 408.69086227416994, 409.055087890625, 409.38404891967775, 410.6030824279785, 411.28859344482424, 411.42721298217776, 412.16980361938477, 412.5238090515137, 412.500760345459, 411.6223515319824, 413.56771133422853, 413.7894569396973, 415.0199526977539, 415.0998258972168, 415.38414306640624, 415.55234893798826, 417.6576263427734, 416.9467268371582, 417.32960189819335, 418.3992501831055, 418.9567008972168, 418.73247451782225, 418.8109378051758, 419.5068016052246, 420.1787438964844, 413.7856233215332, 414.4117384338379, 414.9098822021484, 414.43877014160154, 414.8571179199219, 415.3666098022461, 418.4516133117676, 418.098505859375, 418.75806610107423, 419.42490753173826, 419.2193070983887, 419.21844436645506, 419.80621154785155, 413.9485890197754, 414.1884989929199, 415.42635314941407, 415.74659286499025, 415.83188247680664, 415.8604096984863, 416.65535339355466, 417.1246694946289, 417.62065643310547, 418.4888484191895, 418.6784211730957, 418.2644273376465, 418.3205485534668, 419.1908218383789, 419.77141860961916, 420.59850830078125, 421.40297729492187, 421.2087014770508, 419.84833770751953, 420.5337547302246, 420.92206466674804, 422.00332794189455, 427.0473086547852, 428.01229110717776, 428.6967967224121, 428.55385009765627, 429.0121537780762, 429.4136447143555, 430.3165490722656, 430.2176773071289, 435.50404541015627, 436.603625793457, 445.0381044006348, 445.0642481994629, 445.85575775146486, 457.18504608154296, 459.11526107788086, 458.6306004333496, 461.25294967651365, 460.20461959838866, 460.2438537597656, 460.83374252319334, 463.61114852905274, 464.07486862182617, 465.1908056640625, 466.19696929931644, 466.1080072021484, 466.48639739990233, 466.91536315917966, 467.39205444335937, 467.5763970947266, 468.6297659301758, 469.37219039916994, 468.6895327758789, 469.1384034729004, 469.5978921508789, 470.45301055908203, 470.9082997131348, 473.22685485839844, 475.0528186035156, 476.64483596801756, 477.0530072021484, 477.56824279785155, 478.2537538146973, 481.0348809814453, 483.4669290161133, 483.83148864746096, 482.1234170532227, 482.6652815246582, 483.18337890625, 484.32573837280273, 485.14975814819337, 485.9557293701172, 486.7165985107422, 485.2604379272461, 485.7796481323242, 486.44306549072263, 488.82665786743166, 475.78515548706054, 473.0684780883789, 473.7643267822266, 472.2407875061035, 473.51983627319333, 474.171641998291, 474.6244856262207, 475.5219836425781, 475.7460774230957, 476.6482550048828, 474.7863301086426, 475.76746948242186, 476.5783149719238, 477.3852227783203, 477.17821243286136, 477.8391540527344, 479.56120559692386, 479.16163986206055, 479.6196699523926, 479.9301695251465, 481.3715176391602, 482.2222904968262, 482.9929534912109, 493.0680813598633, 491.4337448120117, 491.85572814941406, 492.9935540771484, 494.4711637878418, 495.4932862854004, 497.6535418701172, 497.3523309326172, 495.22578399658204, 495.86718154907226, 496.4869940185547, 497.51101821899414, 498.5468336486816, 499.5376544189453, 500.5267614746094, 499.1872157287598, 499.5812710571289, 500.57371490478516, 502.71292083740235, 503.3122325134277, 499.9107977294922, 500.7642628479004, 499.5672994995117, 500.5032931518555, 501.1620829772949, 501.9921636962891, 499.77579360961914, 501.84995727539064, 502.6029040527344, 501.5319180297852, 502.06004425048826, 502.68345703125, 503.7954547119141, 504.8996894836426, 505.7767236328125, 506.83288208007815, 505.5538114929199, 506.16900650024417, 506.98980697631833, 511.83282485961917, 510.25742095947265, 511.0812174987793, 509.8629393005371, 507.11608810424804, 508.32479064941407, 508.78693298339846, 510.9563932800293, 512.071063079834, 513.1654200744629, 514.0875495910644, 512.9399717712403, 514.0184907531739, 515.0213763427735, 516.2160569763183, 517.4664526367187, 518.0804122924804, 519.3224122619629, 520.3922552490235, 521.2894393920899, 522.1117236328125, 520.4217106628417, 522.0580496215821, 523.1923709106445, 524.0493205261231, 523.5150360107422, 525.0059996032714, 525.2643307495117, 526.5377784729004, 527.7819453430176, 528.5866207885742, 529.3671548461914, 528.1718112182617, 529.3352975463868, 530.8776138305664, 531.7278344726562, 532.7614880371094, 536.5048852539063, 532.6194612121582, 533.2595529174805, 533.9848989868165, 535.6633758544922, 536.5326152038574, 537.5280349731445, 538.5505233764649, 537.6054039001465, 538.2042590332031, 538.8071810913086, 540.4097274780273, 541.6635757446289, 542.3611415100098, 542.640478668213, 541.5506216430664, 541.4547023010253, 542.2787657165527, 542.9962582397461, 544.2559794616699, 544.5803884887696, 547.6811209106445, 547.2839453125, 547.6540539550781, 549.0629103088379, 549.3920425415039, 550.9026055908204, 553.4221722412109, 554.528782043457, 554.5172761535645, 555.4302882385253, 556.5538102722168, 558.1788900756836, 559.6392283630371, 561.1025073242188, 561.9581393432617, 560.8274301147461, 561.2154244995118, 562.0076020812988, 564.2023249816895, 564.8005708312988, 565.7826249694824, 566.7240534973145, 565.5035765075684, 565.4287017822265, 566.7167874145508, 567.1565222167969, 567.7240269470215, 568.7765095520019, 515.5136169433594, 515.7522596740723, 516.4991841125488, 518.053998260498, 519.076911315918, 522.6881964111328, 523.2801983642578, 526.3348132324219, 524.7137802124023, 525.3222177124023, 526.8464266967774, 527.8660566711426, 530.1104605102539, 530.7932356262207, 533.1597529602051, 532.2477983093262, 535.3212623596191, 534.3257150268555, 537.2477729797363, 537.4939503479004, 537.4149717712403], "mensal": [{"Mes": "2025-12", "GB": 2404.620585547553}, {"Mes": "2025-11", "GB": 2523.372404225667}, {"Mes": "2025-10", "GB": 2440.870108795166}, {"Mes": "2025-09", "GB": 2347.187217458089}, {"Mes": "2025-08", "GB": 2277.6911224857454}, {"Mes": "2025-07", "GB": 2186.991339652769}, {"Mes": "2025-06", "GB": 2168.0144200642903}, {"Mes": "2025-05", "GB": 2009.9564647059287}, {"Mes": "2025-04", "GB": 1896.4608395894368}, {"Mes": "2025-03", "GB": 1875.8293351204165}, {"Mes": "2025-02", "GB": 1812.5626517704554}, {"Mes": "2025-01", "GB": 1710.3294461158014}, {"Mes": "2024-12", "GB": 1860.1607210713048}, {"Mes": "2024-11", "GB": 1680.1326489766438}, {"Mes": "2024-10", "GB": 1611.2222708425213}, {"Mes": "2024-09", "GB": 1523.403646596273}, {"Mes": "2024-08", "GB": 1454.963093419229}, {"Mes": "2024-07", "GB": 1570.7852091635427}, {"Mes": "2024-06", "GB": 1700.7025225321452}, {"Mes": "2024-05", "GB": 1556.7577738608084}, {"Mes": "2024-04", "GB": 1484.2825032552084}, {"Mes": "2024-03", "GB": 1432.9840759277345}]}
        };

        function renderDashboard() {
            const days = parseInt(document.getElementById('periodoSelect').value);
            const lastDateStr = sysConfig.history.x[sysConfig.history.x.length - 1];
            const baseDate = new Date(lastDateStr + "T00:00:00");
            
            
            const finalVol = (sysConfig.slope * (sysConfig.lastOrdinal + days)) + sysConfig.intercept;
            const finalCost = finalVol * sysConfig.priceUnit;
            const currentCost = sysConfig.history.y[sysConfig.history.y.length - 1];
            const delta = finalCost - currentCost;

            document.getElementById('kpi-custo-final').innerText = 'R$ ' + finalCost.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('kpi-delta').innerText = '+ R$ ' + delta.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('kpi-volume').innerText = finalVol.toLocaleString('pt-BR', {maximumFractionDigits: 2}) + ' GB';

            let projX = [], projY = [];
            let monthlyProj = {};
            exportData = []; 

            for (let i = 1; i <= days; i++) {
                let d = new Date(baseDate);
                d.setDate(d.getDate() + i);
                
                let ordinal = sysConfig.lastOrdinal + i;
                let gb = (sysConfig.slope * ordinal) + sysConfig.intercept;
                
                let isoDate = d.toISOString().split('T')[0];
                projX.push(isoDate);
                projY.push(gb * sysConfig.priceUnit);

                let key = isoDate.slice(0, 7); 
                if (!monthlyProj[key]) monthlyProj[key] = [];
                monthlyProj[key].push(gb);
            }

            
            Plotly.newPlot('mainChart', [
                {
                    x: sysConfig.history.x, 
                    y: sysConfig.history.y, 
                    name: 'Gasto Histórico', 
                    type: 'scatter',
                    line: {color: '#0f5132', width: 2} 
                },
                { 
                    x: projX, 
                    y: projY, 
                    name: 'Tendência Projetada', 
                    type: 'scatter',
                    line: {color: '#004a8f', dash: 'dash', width: 2} 
                }
            ], { 
                template: 'plotly_white', 
                margin: {t:20, r:20, b:40, l:60},
                legend: {orientation: 'h', y: 1.1},
                yaxis: {tickprefix: 'R$ '}
            });

            let rows = "";
            
        
            Object.keys(monthlyProj).sort().reverse().forEach(m => {
                let vals = monthlyProj[m];
                let avg = vals.reduce((a, b) => a + b) / vals.length;
                let cost = avg * sysConfig.priceUnit;
                
                rows += `<tr>
                    <td>${m}</td>
                    <td>${avg.toLocaleString('pt-BR', {maximumFractionDigits: 2})}</td>
                    <td>R$ ${cost.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td><span class="status-tag tag-proj">Projetado</span></td>
                </tr>`;

                exportData.push({mes: m, gb: avg, val: cost, type: 'Projetado'});
            });

            sysConfig.history.mensal.forEach(r => {
                let cost = r.GB * sysConfig.priceUnit;
                rows += `<tr>
                    <td>${r.Mes}</td>
                    <td>${r.GB.toLocaleString('pt-BR', {maximumFractionDigits: 2})}</td>
                    <td>R$ ${cost.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td><span class="status-tag tag-real">Realizado</span></td>
                </tr>`;

                exportData.push({mes: r.Mes, gb: r.GB, val: cost, type: 'Real'});
            });

            document.getElementById('tableBody').innerHTML = rows;
        }

        function exportToCSV() {
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF"; 
            csvContent += "Mes/Ano;Volume Medio (GB);Custo Estimado (R$);Status\n";

            exportData.forEach(row => {
                let v_gb = row.gb.toFixed(2).replace('.', ',');
                let v_val = row.val.toFixed(2).replace('.', ',');
                csvContent += `${row.mes};${v_gb};${v_val};${row.type}\n`;
            });

            const link = document.createElement("a");
            link.href = encodeURI(csvContent);
            link.download = "relatorio_infra_export.csv";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        window.onload = renderDashboard;
    </script>
</body>
</html>
